<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SusanAI - Login</title>
</head>
<body>
  <h1>Welcome to SusanAI</h1>

  <!-- ปุ่ม Login -->
  <button id="login-btn">Login with World ID</button>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // ✅ ถ้ามี access_token อยู่แล้ว → redirect ไป firebirdre/
      const token = localStorage.getItem("access_token");
      if (token) {
        window.location.href = "/firebirdre/";
        return;
      }

      // ✅ ถ้ายังไม่มี token → แสดงปุ่ม Login
      const loginBtn = document.getElementById("login-btn");
      loginBtn.addEventListener("click", function () {
        // ส่งไปหน้า Worldcoin OIDC authorize endpoint
        const clientId = "app_57493e6e2fb2153a6a50c98e358b4785";
        const redirectUri = "https://winaiac.github.io/firebirdre/callback.html";
        const scope = "openid profile";
        const state = "random_state_" + Math.random().toString(36).substring(2);

        const authorizeUrl = `https://id.worldcoin.org/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(
          redirectUri
        )}&response_type=code&scope=${encodeURIComponent(scope)}&state=${state}`;

        window.location.href = authorizeUrl;
      });
    });
  </script>
</body>
</html>
