<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebird Re - เชื่อมต่อกับ World ID</title>
    
    <!-- เพิ่มสไตล์เล็กน้อยเพื่อให้ดูดีขึ้น -->
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            color: #1c1e21;
            text-align: center;
        }
        .container {
            background: white;
            padding: 2rem 3rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #d9534f; /* สีแดงสไตล์ Firebird */
        }
        p {
            margin-bottom: 2rem;
            font-size: 1.1rem;
            color: #606770;
        }
        /* นี่คือส่วนที่ปุ่ม World ID จะแสดง */
        #worldcoin-button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 50px; /* กำหนดความสูงขั้นต่ำเผื่อไว้ */
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- เนื้อหาเดิมของคุณ -->
        <h1>Firebird Re</h1>
        <p>ยินดีต้อนรับ! ยืนยันตัวตนของคุณเพื่อเข้าสู่ระบบ</p>

        <!-- สร้างตำแหน่งสำหรับวางปุ่ม World ID -->
        <div id="worldcoin-button-container"></div>
    </div>

    <!-- Script ของ World ID Kit: เพิ่ม onload="initWorldID()" -->
    <!-- การทำเช่นนี้เป็นการสั่งให้เบราว์เซอร์เรียกใช้ฟังก์ชัน initWorldID() หลังจากที่ไฟล์ idkit.js โหลดเสร็จแล้วเท่านั้น -->
    <script src="https://unpkg.com/@worldcoin/idkit@latest/build/idkit.js" onload="initWorldID()"></script>

    <!-- โค้ด JavaScript สำหรับตั้งค่า World ID -->
    <script type="text/javascript">
        // ห่อหุ้มโค้ดทั้งหมดไว้ในฟังก์ชัน initWorldID
        function initWorldID() {
            // ฟังก์ชันที่จะทำงานเมื่อผู้ใช้ยืนยันตัวตนสำเร็จ
            const onSuccess = (result) => {
                console.log("การยืนยันตัวตนสำเร็จ:", result);
                alert("ยืนยันตัวตนสำเร็จ! ยินดีต้อนรับสู่ Firebird Re");
                document.querySelector('.container').innerHTML = '<h1>ยืนยันตัวตนสำเร็จ!</h1><p>ขอบคุณที่ใช้ World ID</p>';
            };

            // ฟังก์ชันที่จะทำงานเมื่อมีข้อผิดพลาด
            const onError = (error) => {
                console.error("เกิดข้อผิดพลาด:", error);
                alert("การยืนยันตัวตนล้มเหลว กรุณาลองใหม่อีกครั้ง");
            };

            // เริ่มการทำงานของ IDKit เพื่อสร้างปุ่ม
            try {
                // ตรวจสอบอีกครั้งให้แน่ใจว่า window.IDKit พร้อมใช้งาน
                if (window.IDKit) {
                    window.IDKit.init({
                        container: document.getElementById('worldcoin-button-container'),
                        
                        // --- ✅ อัปเดตเรียบร้อยแล้ว ---
                        app_id: "app_b67c4099dbab19c76ac3cae0a78a89f0", 
                        
                        // ใส่ชื่อ Action ที่คุณสร้างไว้ใน Portal
                        action: "login-firebird", 
                        //------------------------------------

                        onSuccess: onSuccess,
                        onError: onError,
                    });
                } else {
                     // กรณีที่เกิดปัญหาไม่คาดคิดและ IDKit ยังไม่พร้อม
                    throw new Error("IDKit script loaded but window.IDKit is not available.");
                }
            } catch (error) {
                console.error("ไม่สามารถเริ่มต้น IDKit ได้:", error);
                document.getElementById('worldcoin-button-container').innerText = "ไม่สามารถโหลดปุ่ม World ID ได้";
            }
        }
    </script>

</body>
</html>
